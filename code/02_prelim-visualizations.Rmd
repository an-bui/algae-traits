---
title: "preliminary visualizations"
author: "An Bui"
date: "10/6/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 0. set up
```{r}
# source the cleaning/summarizing script, which sources the set up
source(here::here("code", "01_cleaning-and-summarizing.R"))
```

# 1. FvFm 

## a. box plot

```{r}
fvfm_boxplot <- ggplot(fvfm_summary, aes(x = sp_code, y = mean)) +
  geom_boxplot() +
  geom_jitter(alpha = 0.45) +
  facet_wrap(~ pigment_type, scales = "free_x") +
  scale_x_discrete(guide = guide_axis(n.dodge = 2)) +
  theme_bw() +
  labs(title = "Photosynthetic efficiency",
       x = "Species code",
       y = "Fv/Fm")

fvfm_boxplot

# ggsave(here::here("figures/prelim-visualizations",
#                   paste("fvfm-boxplot-", todays_date, ".jpg", sep = "")),
#        fvfm_boxplot,
#        width = 8, height = 5, dpi = 150)
```

# 2. Thickness

## a. box plot

```{r}
thickness_boxplot <- ggplot(thickness_summary, aes(x = sp_code, y = mean)) +
  geom_boxplot() +
  geom_jitter(alpha = 0.45) +
  facet_wrap(~ pigment_type, scales = "free_x") +
  scale_x_discrete(guide = guide_axis(n.dodge = 2)) +
  theme_bw() +
  labs(title = "Thallus thickness",
       x = "Species code",
       y = "Thickness (mm)")

thickness_boxplot

# ggsave(here::here("figures/prelim-visualizations",
#                   paste("thickness-boxplot-", todays_date, ".jpg", sep = "")),
#        thickness_boxplot,
#        width = 8, height = 5, dpi = 150)
```

# 3. Weights

## a. box plot

```{r}
dryw_boxplot <- ggplot(weight_summary, aes(x = sp_code, y = weight_dry_g)) +
  geom_boxplot() +
  geom_jitter(alpha = 0.45) +
  facet_wrap(~ pigment_type, scales = "free_x") +
  scale_x_discrete(guide = guide_axis(n.dodge = 2)) +
  theme_bw()  +
  labs(title = "Oven dry weight",
       x = "Species code",
       y = "Dry weight (g)")

dryw_boxplot

# ggsave(here::here("figures/prelim-visualizations",
#                   paste("dryw-boxplot-", todays_date, ".jpg", sep = "")),
#        dryw_boxplot,
#        width = 8, height = 5, dpi = 150)

wetw_boxplot <- ggplot(weight_summary, aes(x = sp_code, y = weight_wet_g)) +
  geom_boxplot() +
  geom_jitter(alpha = 0.45) +
  facet_wrap(~ pigment_type, scales = "free_x") +
  scale_x_discrete(guide = guide_axis(n.dodge = 2)) +
  theme_bw()  +
  labs(title = "Fresh wet weight",
       x = "Species code",
       y = "Wet weight (g)")

wetw_boxplot

# ggsave(here::here("figures/prelim-visualizations",
#                   paste("wetw-boxplot-", todays_date, ".jpg", sep = "")),
#        wetw_boxplot,
#        width = 8, height = 5, dpi = 150)

tdmc_boxplot <- ggplot(weight_summary %>% filter(sp_code != "BO"), aes(x = sp_code, y = tdmc)) +
  geom_boxplot() +
  geom_jitter(alpha = 0.45) +
  facet_wrap(~ pigment_type, scales = "free_x") +
  scale_x_discrete(guide = guide_axis(n.dodge = 2)) +
  theme_bw() +
  labs(title = "Thallus dry matter content",
       x = "Species code",
       y = "g dry weight/g wet weight")

tdmc_boxplot

# ggsave(here::here("figures/prelim-visualizations",
#                   paste("tdmc_boxplot-", todays_date, ".jpg", sep = "")),
#        tdmc_boxplot,
#        width = 8, height = 5, dpi = 150)
```

As a note: something needs to happen to be able to filter out the things that are true thalli (e.g. thallus on PTCA) AND things that are whole individuals that are basically thalli (e.g. BF). Maybe code those in as "thallus" and go from there?  

Note: Changed that on 2021-10-25. If it's a whole individual that is a thallus, it's coded in as "thallus" in the weight data sheet.

# 4. volume

## a. box plot
```{r}
volume_boxplot <- ggplot(volume_summary, aes(x = sp_code, y = volume_total_mL)) +
  geom_boxplot() +
  geom_jitter(alpha = 0.45) +
  facet_wrap(~ pigment_type, scales = "free_x") +
  scale_x_discrete(guide = guide_axis(n.dodge = 2)) +
  theme_bw() +
  labs(title = "Volume",
       x = "Species code",
       y = "Volume (mL)")

volume_boxplot

# ggsave(here::here("figures/prelim-visualizations",
#                   paste("volume-boxplot-", todays_date, ".jpg", sep = "")),
#        volume_boxplot,
#        width = 8, height = 5, dpi = 150)
```

# 5. surface area

## a. box plot
```{r}
sa_boxplot <- ggplot(sa_peri_summary, aes(x = sp_code, y = area_total)) +
  geom_boxplot() +
  geom_jitter(alpha = 0.45) +
  facet_wrap(~ pigment_type, scales = "free_x") +
  scale_x_discrete(guide = guide_axis(n.dodge = 2)) +
  theme_bw() +
  labs(title = "Surface area",
       x = "Species code",
       y = bquote("Square millimeter "(mm^2)))

sa_boxplot

# ggsave(here::here("figures/prelim-visualizations",
#                   paste("sa-boxplot-", todays_date, ".jpg", sep = "")),
#        sa_boxplot,
#        width = 8, height = 5, dpi = 150)
```

# 6. perimeter

## a. box plot
```{r}
peri_boxplot <- ggplot(sa_peri_summary, aes(x = sp_code, y = peri_total)) +
  geom_boxplot() +
  geom_jitter(alpha = 0.45) +
  facet_wrap(~ pigment_type, scales = "free_x") +
  scale_x_discrete(guide = guide_axis(n.dodge = 2)) +
  theme_bw() +
  labs(title = "Perimeter",
       x = "Species code",
       y = "Perimeter (mm)")

peri_boxplot

# ggsave(here::here("figures/prelim-visualizations",
#                   paste("peri_boxplot-", todays_date, ".jpg", sep = "")),
#        peri_boxplot,
#        width = 8, height = 5, dpi = 150)
```

# 7. surface area:perimeter ratio

## a. box plot

```{r}
ratio_saperi_boxplot <- ggplot(sa_peri_summary, aes(x = sp_code, y = ratio)) +
  geom_boxplot() +
  geom_jitter(alpha = 0.45) +
  facet_wrap(~ pigment_type, scales = "free_x") +
  scale_x_discrete(guide = guide_axis(n.dodge = 2)) +
  theme_bw() +
  labs(title = "Surface area:perimeter ratio",
       x = "Species code",
       y = expression(paste(mm^2, "per mm")))

ratio_saperi_boxplot 

# ggsave(here::here("figures/prelim-visualizations",
#                   paste("ratio_saperi_boxplot-", todays_date, ".jpg", sep = "")),
#        ratio_saperi_boxplot,
#        width = 8, height = 5, dpi = 150)
```

# 8. surface area:volume ratio

## a. box plot
```{r}
ratio_savolume_boxplot <- ggplot(ratio_savolume, aes(x = sp_code, y = ratio)) +
  geom_boxplot() +
  geom_jitter(alpha = 0.45) +
  facet_wrap(~ pigment_type, scales = "free_x") +
  scale_x_discrete(guide = guide_axis(n.dodge = 2)) +
  theme_bw() +
  labs(title = "Surface area:volume ratio",
       x = "Species code",
       y = "mm^2/mL")

ratio_savolume_boxplot

# ggsave(here::here("figures/prelim-visualizations",
#                   paste("ratio_savolume_boxplot-", todays_date, ".jpg", sep = "")),
#        ratio_savolume_boxplot,
#        width = 8, height = 5, dpi = 150)
```

# 9. maximum height and width

```{r}
height_boxplot <- ggplot(hw_summary, aes(x = sp_code, y = max_height_cm)) +
  geom_boxplot() +
  geom_jitter(alpha = 0.45) +
  facet_wrap(~ pigment_type, scales = "free_x") +
  scale_x_discrete(guide = guide_axis(n.dodge = 2)) +
  theme_bw() +
  labs(title = "Maximum height",
       x = "Species code",
       y = "cm")

height_boxplot

# ggsave(here::here("figures/prelim-visualizations",
#                   paste("height_boxplot-", todays_date, ".jpg", sep = "")),
#        height_boxplot,
#        width = 8, height = 5, dpi = 150)

width_boxplot <- ggplot(hw_summary, aes(x = sp_code, y = max_width_cm)) +
  geom_boxplot() +
  geom_jitter(alpha = 0.45) +
  facet_wrap(~ pigment_type, scales = "free_x") +
  scale_x_discrete(guide = guide_axis(n.dodge = 2)) +
  theme_bw() +
  labs(title = "Maximum width",
       x = "Species code",
       y = "cm")

width_boxplot

# ggsave(here::here("figures/prelim-visualizations",
#                   paste("width_boxplot-", todays_date, ".jpg", sep = "")),
#        width_boxplot,
#        width = 8, height = 5, dpi = 150)
```

# 10. specific thallus area

thallus area:dry weight

```{r}
sta_boxplot <- ggplot(sta_summary %>% drop_na(sta_mm_mg) %>% slice(-125), aes(x = sp_code, y = sta_mm_mg)) +
  geom_boxplot() +
  geom_jitter(alpha = 0.45) +
  facet_wrap(~ pigment_type, scales = "free_x") +
  scale_x_discrete(guide = guide_axis(n.dodge = 2)) +
  theme_bw() +
  labs(title = "Specific thallus area",
       x = "Species code",
       y = "Thallus area/dry weight (mm^2/mg)")

sta_boxplot

# ggsave(here::here("figures/prelim-visualizations",
#                   paste("sta_boxplot-", todays_date, ".jpg", sep = "")),
#        sta_boxplot,
#        width = 8, height = 5, dpi = 150)
```

# 11. branching order

```{r}
bra_ord_boxplot <- ggplot(bra_ord_summary, aes(x = sp_code, y = mean)) +
  geom_boxplot() +
  geom_jitter(alpha = 0.45) +
  facet_wrap(~ pigment_type, scales = "free_x") +
  scale_x_discrete(guide = guide_axis(n.dodge = 2)) +
  theme_bw() +
  labs(title = "Branching order",
       x = "Species code",
       y = "Branch count")

bra_ord_boxplot

# ggsave(here::here("figures/prelim-visualizations",
#                   paste("bra_ord_boxplot-", todays_date, ".jpg", sep = "")),
#        bra_ord_boxplot,
#        width = 8, height = 5, dpi = 150)
```

# 12. toughness

```{r}
toughness_boxplot <- ggplot(toughness_summary, aes(x = sp_code, y = mean)) +
  geom_boxplot() +
  geom_jitter(alpha = 0.45) +
  facet_wrap(~ pigment_type, scales = "free_x") +
  scale_x_discrete(guide = guide_axis(n.dodge = 2)) +
  theme_bw() +
  labs(title = "Toughness",
       x = "Species code",
       y = "kg/cm2")

toughness_boxplot

ggsave(here::here("figures/prelim-visualizations",
                  paste("toughness_boxplot-", todays_date, ".jpg", sep = "")),
       toughness_boxplot,
       width = 8, height = 5, dpi = 150)
```










